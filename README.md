If you find this software useful in your research, please cite us using the following .bib entry:
 
 ```
@article{Choi2021Sim,
  title={An assessment tool for Computer-Assisted Semen Analysis (CASA) algorithms},
  author={Choi, Ji-won and Alkhoury, Ludvik and Urbano, Leonardo and Masson, Puneet and VerMilyea, Matthew and Kam, Moshe},
  journal={},
  volume={},
  pages={},
  year={},
  publisher={}
}
 
 ```
 
# Sperm Simulator - NJIT Data Fusion Lab

This repository contains the software and MATLAB codes for Sperm Simulator. The methods of simulation are explained in [1].

To install the stand-alone software for the simulator, please download and run SpermSimulator_V6_00-installer.exe. The software has been tested for Windows 10.

The software was built using the MATLAB Compiler (MATLAB version R2020b) and requires MATLAB Runtime to run. The installer should prompt the user to download the MATLAB Runtime. One is able to also simply download and install MATLAB Runtime using the following link:
https://www.mathworks.com/products/compiler/matlab-runtime.html

The software does not require MATLAB license. 

The raw MATLAB codes for the sperm simulator can be found in the __Sperm_Simulator_v6_00_MATLAB_codes__ folder.

The main file to run the simulator is Sperm_Simulator_v6_00.m.

Once the simulator opens, one should see the graphical user interface (GUI) similar to figure 1.

![alt text](https://github.com/JiwonChoi-NJIT/NJIT_sperm_simulator/blob/main/Sperm_Simulator_V6_GUI.PNG)
Figure.1 Graphical User Interface of Sperm Simulator Version 6.00

The appearance of the GUI may differ depending on the operating system and screen resolution.

Sample outputs of the simulator are available in Simulated Semen Image folder in this repository.

For detailed guide for the software, please refer to the user manual (.pdf) in this repository.

### Simulated Human Semen Samples (Simulated Semen Images folder)
The simulated images were generated using the simulation method described in [1]. 

The simulated semen images were generated by using the simulation parameters (size of sperm head) calculated from sample ID005 (referred to as Sample 1 in [1] can be found in [2]). The simulation parameters used to simulate the images are given in Table 1.

Table 1. Simulation Parameters for the Simulated Semen Images (please refer to [1] for explanation of each parameters)
| Head distribution (Horizontal)   | Head distribution (Vertical)  | Membrane to Head Dist. Ratio | Tail Width Distribution| Tail Length | Background Intensity |
| :-----: | :-: | :-: | :-: | :-: |  :-: |
| 1.86 | 2.86 | 1.5 | 1.5 | 40 | 80% (204) |

All images were generated to have 40 cells total (maximum number of cells in a frame is 40). In each sample, the cells exhibited one of the four swimming modes: (1) linear-mean, (2) circular, (3) hyperactive, or (4) immotile. Each sample contains 10 cells of each swimming modes.

There are five folders each with different simulation settings (1 sample image per folder, a total of 5 images).
1. 15 fps: simulated semen images with framerate of 15 fps. There was no additive noise, variation of intensity of sperm heads, or transition of swimming modes.
2. 60 fps: simulated semen images with framerate of 60 fps. There was no additive noise, variation of intensity of sperm heads, or transition of swimming modes.
3. 60 fps swim change: simulated semen images with framerate of 60 fps. There was no additive noise or variation of intensity of sperm heads. The mode of swimming changed every 1 second with the following transition probability matrix (Table 2, see the simulation user manual):

Table 2. Transition Probability Matrix of Swimming Modes
| | LM   | C  | H | I |
| :-----: | :-----: | :-: | :-: | :-: |
|    LM     | 0.95  | 0.04  | 0.01 | 0 |
|     C    | 0.04   | 0.95  | 0.01 | 0 |
|     H    | 0.05   | 0.05  | 0.90 | 0 |
|      I   | 0   | 0  | 0 | 1 |

4. 60 fps varying intensity: simulated semen images with framerate of 60 fps. The head intensity varied from value 0 to 204. There was no additive noise or transition of swimming modes.
5. 60 fps varying intensity with additive noise (displacement): simulated semen images with framerate of 60 fps. The head intensity varied from value 0 to 204. A random noise with zero-mean Gaussian with standard deviation of 3 was added to the position of every sperm cell. There was transition of swimming modes.

Each image is accompanied by a ground truth data file (.csv) and an image with previous track shown in blue (previous 0.5 seconds). The labels for each column of the ground truth data file (.csv) are shown in Table 3.

Table 3. Column Labels for Ground Truth Data File (.csv) 
| 1. Cell Index  | 2. x position   | 3. y position  | 4. Head angle | 5. Frame index | 6. Swim Type | 7. Swim Direction Change Flag |
| :-----: | :-----: | :-: | :-: | :-: | :-: | :-: |

* Cell Index: index _i_ for each sperm cell
* x position: horizontal position of the sperm cell _i_
* y position: vertical position of the sperm cell _i_
* Head angle: head angle of the sperm cell _i_
* Frame index: frame index/number
* Swim type: (0) Linear-mean, (1) circular, (2) hyperactive, (3) immotile
* Swim direction change flag: flag to indicate the direction has changed for linear mean swimming cell has occurred. The change in direction occurs when the linear mean swimming cell exits the frame.


# Reference
[1] "An assessment tool for Computer-Assisted Semen Analysis (CASA) algorithms" Simulation Paper - citation not finalized

[2] Choi, J.-w., Alkhoury, L., Kam, M.: Human Semen Images - NJIT Data Fusion Lab, https://github.com/JiwonChoi-NJIT/NJIT_semen_images_Data_Fusion_Lab (2021 (accessed November 24, 2021))
